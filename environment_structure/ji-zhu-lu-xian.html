<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>南大先腾开源计划 | 技术体系设计</title>
    <meta name="description" content="南大先腾开源计划">
    
    <link rel="preload" href="/assets/css/styles.fd345311.css" as="style"><link rel="preload" href="/assets/js/app.fd345311.js" as="script"><link rel="preload" href="/assets/js/6.27f6fe8f.js" as="script"><link rel="prefetch" href="/assets/js/1.e1ed89c0.js"><link rel="prefetch" href="/assets/js/0.bb40ecae.js"><link rel="prefetch" href="/assets/js/2.9bb309d0.js"><link rel="prefetch" href="/assets/js/3.d7d8d861.js"><link rel="prefetch" href="/assets/js/4.f10e001e.js"><link rel="prefetch" href="/assets/js/5.feed3861.js"><link rel="prefetch" href="/assets/js/7.36481b91.js"><link rel="prefetch" href="/assets/js/8.5dd4f98f.js"><link rel="prefetch" href="/assets/js/9.1c065b98.js"><link rel="prefetch" href="/assets/js/10.cbc1eb49.js"><link rel="prefetch" href="/assets/js/11.3fa0664b.js">
    <link rel="stylesheet" href="/assets/css/styles.fd345311.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="router-link-active"><!----><span class="site-name">
      南大先腾开源计划
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/environment_structure/" class="nav-link router-link-active">框架的总体设计</a></div><div class="nav-item"><a href="/projects/" class="nav-link">项目介绍</a></div><div class="nav-item"><a href="/UPDATE_LOG.html" class="nav-link">更新记录</a></div><!----></nav></div></header><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/environment_structure/" class="nav-link router-link-active">框架的总体设计</a></div><div class="nav-item"><a href="/projects/" class="nav-link">项目介绍</a></div><div class="nav-item"><a href="/UPDATE_LOG.html" class="nav-link">更新记录</a></div><!----></nav><ul class="sidebar-links"><li><a href="/environment_structure/" class="sidebar-link">框架的总体设计</a></li><li><a href="/environment_structure/ji-zhu-lu-xian.html" class="active sidebar-link">技术体系设计</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/environment_structure/ji-zhu-lu-xian.html#统一技术栈" class="sidebar-link">统一技术栈</a></li><li class="sidebar-sub-header"><a href="/environment_structure/ji-zhu-lu-xian.html#前后端数据通讯格式" class="sidebar-link">前后端数据通讯格式</a></li><li class="sidebar-sub-header"><a href="/environment_structure/ji-zhu-lu-xian.html#参数驱动sql" class="sidebar-link">参数驱动SQL</a></li><li class="sidebar-sub-header"><a href="/environment_structure/ji-zhu-lu-xian.html#数据持久化" class="sidebar-link">数据持久化</a></li><li class="sidebar-sub-header"><a href="/environment_structure/ji-zhu-lu-xian.html#mvc分层设计和脚手架" class="sidebar-link">MVC分层设计和脚手架</a></li></ul></li><li><a href="/environment_structure/tong-yong-hou-tai-gong-neng.html" class="sidebar-link">平台功能设计</a></li><li><a href="/environment_structure/kuang-jia-ping-tai-jie-shao.html" class="sidebar-link">框架体系结构</a></li><li><a href="/environment_structure/hou-tai-fu-wu.html" class="sidebar-link">工具和服务模块</a></li></ul></div><div class="page"><div class="content"><h1 id="技术体系设计"><a href="#技术体系设计" aria-hidden="true" class="header-anchor">#</a> 技术体系设计</h1><p>技术方面既要跟上快速的发展步伐又要减少学习成本同事还要兼顾开发人员的使用习惯，本身就是一个非常矛盾的事情；也是没有办法做到尽善尽美的。框架在技术方面的目标是让开发人员不需要学习太多的新的技术就可以使用框架，比如你不需要知道spring security的机制和原理，只要按照框架的约定开发，就已经应用了这个安全框架；让开发人员把跟多的精力集中在业务的理解和实现上。框架的设计理念和spring boot 非常相像，没有直接采用spring boot 的原因是在框架设计之初spring boot还没有流行，我们还不知道有这个东西；现在我们的框架已经将所有的配置信息和业务代码剥离可以直接一直到spring boot项目中。</p><p>技术体系设计主要考虑一下内容：</p><ol><li><p>统一的功能权限、数据范围权限控制。</p></li><li><p>统一的用户、机构及关联关系，目的是为了统一实现工作流程设定。</p></li><li><p>统一技术栈，减少员工的交流成本。技术栈在满足业务需求的情况下尽量减少，并且适当找过开发人员的使用习惯。</p></li><li><p>不重复发明轮子，但也不为此而对业务需求进行妥协。</p></li></ol><p><strong>特别说明一下第4点，框架更多的是一个代码联合剂将众多开源平台整合在一起、所以某种意义上也可以说框架是一个学习教程。但是我们还是在两个方面发明了自己的轮子，一：参数驱动sql 二：工作流引擎，具体原因参见对应的章节。</strong></p><h2 id="统一技术栈"><a href="#统一技术栈" aria-hidden="true" class="header-anchor">#</a> 统一技术栈</h2><h3 id="框架平台的技术路线"><a href="#框架平台的技术路线" aria-hidden="true" class="header-anchor">#</a> 框架平台的技术路线</h3><p>框架经过多少改版，现在基本上全面拥抱spring体系，并且可以很容易的迁移到spring boot。框架现在是4.0版本，相比3.×最大的变化就是前后端分离，前端页面显示和后端的逻辑设计完全分离。</p><h3 id="前端技术路线"><a href="#前端技术路线" aria-hidden="true" class="header-anchor">#</a> 前端技术路线</h3><p>目前前端有一套基于<a href="https://github.com/ndxt/centit-ui/tree/master/framework-base-view-easyui" target="_blank" rel="noopener noreferrer">easyui</a>的框架，正在研发一套基于vue的框架。</p><h3 id="后端技术路线"><a href="#后端技术路线" aria-hidden="true" class="header-anchor">#</a> 后端技术路线</h3><p>后端采用的主要技术栈如下：</p><ol><li>基本算法类采用 apache commons系列。</li><li><a href="https://github.com/ndxt/centit-commons" target="_blank" rel="noopener noreferrer">centit-commons</a> 作为基础算法的补充，其中最为重要的是<a href="https://github.com/ndxt/centit-commons/tree/master/centit-compiler" target="_blank" rel="noopener noreferrer">compiler</a>一个简化四则运算作为框架的规则引擎使用。</li><li>采用fastjson作为json的解析工具。</li><li>采用spring作为bean的容器和事务管理工具，spring mvc作为后端分层模型，spring security作为安全框架。spring 采用4.×版本。</li><li>持久化公司<a href="https://github.com/ndxt/centit-persistence" target="_blank" rel="noopener noreferrer"><strong>centit-persistence</strong></a>工具类对spring-jdbc、Mybatis、Hibernate进行封装，使其都可以支持 参数驱动sql。推荐使用<a href="https://github.com/ndxt/centit-persistence/tree/master/centit-persistence-jdbc" target="_blank" rel="noopener noreferrer">centit-persistence-jdbc</a>它用sping jdbc实现了jpa使用和hibernate一样便捷，并且查询更加灵活。</li><li>采用json格式作为前后端的数据通讯格式。</li><li>采用restful风格的接口规范。</li></ol><h2 id="前后端数据通讯格式"><a href="#前后端数据通讯格式" aria-hidden="true" class="header-anchor">#</a> 前后端数据通讯格式</h2><p>框架现在是4.0版本，相比3.×最大的变化就是前后端分离，前端页面显示和后端的逻辑设计完全分离，部署在不同的服务容器上。框架强力建议前段采用html+js（或者js框架比如 easyui、vue等等）的静态方案，但是这并不是强制，开发依然可以使用jsp、velocity等等前段解决方案，但是要求前段必须单独一个服务。这样做的目的是要求开发组将后端的业务通过接口的方式抽象出来，好处是不同平台的客户端，pc端、iOS、Android等等可以用共同的后端。减少后期的维护成本。</p><p>后端采用restful风格的接口，前后端用json的数据格式交换。后端除了返回单个数字、字符串、布尔型等标量其他的json都要符合<a href="http://gitlab.centit.com/gitlab/ctm/centit-framework/blob/master/framework-adapter/src/main/java/com/centit/framework/common/ResponseData.java" target="_blank" rel="noopener noreferrer">ResponseData</a>定义的接口标准。</p><pre class="language-java"><code>    <span class="token comment">// http://gitlab.centit.com/gitlab/ctm/centit-framework/blob/master/framework-adapter\</span>
    <span class="token comment">// /src/main/java/com/centit/framework/common/ResponseData.java</span>
    <span class="token comment">//JSON有三个域，其中data</span>
    String RES_CODE_FILED<span class="token operator">=</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">;</span>    
    String RES_MSG_FILED<span class="token operator">=</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">;</span>
    String RES_DATA_FILED<span class="token operator">=</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//处理结果，0标识正常，其他的为错误号  ，具体错误好参见接口中的注释 </span>
    <span class="token keyword">int</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//处理结果的文字说明</span>
    String <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//返回数据，可以是任何类型数据包括数组，如果返回多个结果可以用Map</span>
    Object <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>这个接口有两个具体的实现<a href="http://gitlab.centit.com/gitlab/ctm/centit-framework/blob/master/framework-adapter/src/main/java/com/centit/framework/common/ResponseSingleData.java" target="_blank" rel="noopener noreferrer">ResponseSingleData</a>和<a href="http://gitlab.centit.com/gitlab/ctm/centit-framework/blob/master/framework-adapter/src/main/java/com/centit/framework/common/ResponseMapData.java" target="_blank" rel="noopener noreferrer">ResponseMapData</a>，在客户端接受到这个JSON时可以用<a href="http://gitlab.centit.com/gitlab/ctm/centit-framework/blob/master/framework-adapter/src/main/java/com/centit/framework/common/ResponseJSON.java" target="_blank" rel="noopener noreferrer">ResponseJSON</a>来解析。框架中<a href="http://gitlab.centit.com/gitlab/ctm/centit-framework/blob/master/framework-adapter/src/main/java/com/centit/framework/common/JsonResultUtils.java" target="_blank" rel="noopener noreferrer">JsonResultUtils</a>类提供了直接向HttpServletResponse写符合上述格式要求的JSON的便捷方法。所以在controller类中可以有多种方式来实现json格式的数据返回，示例代码如下：</p><pre class="language-java"><code><span class="token comment">//返回一个标量,比如:数字\字符串\布尔值等等</span>
     <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/checkuserpower/{optId}/{method}&quot;</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token punctuation">{</span> RequestMethod<span class="token punctuation">.</span>GET <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token annotation punctuation">@ResponseBody</span>
     <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkUserOptPower</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> String optId<span class="token punctuation">,</span>
                                  <span class="token annotation punctuation">@PathVariable</span> String method<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> CodeRepositoryUtil
                <span class="token punctuation">.</span><span class="token function">checkUserOptPower</span><span class="token punctuation">(</span>optId<span class="token punctuation">,</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">//或者</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/checkuserpower/{optId}/{method}&quot;</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token punctuation">{</span> RequestMethod<span class="token punctuation">.</span>GET <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">checkUserOptPower</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> String optId<span class="token punctuation">,</span>
                                  <span class="token annotation punctuation">@PathVariable</span> String method<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">boolean</span> s <span class="token operator">=</span> CodeRepositoryUtil
                <span class="token punctuation">.</span><span class="token function">checkUserOptPower</span><span class="token punctuation">(</span>optId<span class="token punctuation">,</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>
        JsonResultUtils<span class="token punctuation">.</span><span class="token function">writeOriginalObject</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">//只返回处理结果</span>

    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/setuserposition/{userUnitId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> ResponseData <span class="token function">setUserCurrentStaticn</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> String userUnitId<span class="token punctuation">,</span>
            HttpServletRequest request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        CentitUserDetails currentUser <span class="token operator">=</span> WebOptUtils<span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>currentUser<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseSingleData</span><span class="token punctuation">(</span>ResponseData<span class="token punctuation">.</span>ERROR_SESSION_TIMEOUT<span class="token punctuation">,</span>
                    <span class="token string">&quot;用户没有登录或者超时，请重新登录。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseSingleData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">//或者</span>
    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/setuserposition/{userUnitId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserCurrentStaticn</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> String userUnitId<span class="token punctuation">,</span>
            HttpServletRequest request<span class="token punctuation">,</span>HttpServletResponse response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        CentitUserDetails currentUser <span class="token operator">=</span> WebOptUtils<span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>currentUser<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            JsonResultUtils<span class="token punctuation">.</span><span class="token function">writeErrorMessageJson</span><span class="token punctuation">(</span>ResponseData<span class="token punctuation">.</span>ERROR_SESSION_TIMEOUT<span class="token punctuation">,</span>
                    <span class="token string">&quot;用户没有登录或者超时，请重新登录。&quot;</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        JsonResultUtils<span class="token punctuation">.</span><span class="token function">writeSuccessJson</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">//返回单个数据</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;userranks/{rank}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> ResponseData <span class="token function">listUserUnitsByRank</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> String rank<span class="token punctuation">)</span><span class="token punctuation">{</span>
        CentitUserDetails centitUserDetails <span class="token operator">=</span> WebOptUtils<span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>centitUserDetails <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseSingleData</span><span class="token punctuation">(</span>ResponseData<span class="token punctuation">.</span>ERROR_UNAUTHORIZED<span class="token punctuation">,</span> <span class="token string">&quot;用户没有登录或者超时，请重新登录&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> ResponseSingleData<span class="token punctuation">.</span><span class="token function">makeResponseData</span><span class="token punctuation">(</span>
                DictionaryMapUtils<span class="token punctuation">.</span><span class="token function">objectsToJSONArray</span><span class="token punctuation">(</span>
                CodeRepositoryUtil<span class="token punctuation">.</span><span class="token function">listUserUnitsByRank</span><span class="token punctuation">(</span>centitUserDetails<span class="token punctuation">.</span><span class="token function">getUserCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rank<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">//或者    </span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;userranks/{rank}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">listUserUnitsByRank</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> String rank<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span><span class="token punctuation">{</span>
        CentitUserDetails centitUserDetails <span class="token operator">=</span> WebOptUtils<span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>centitUserDetails <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            JsonResultUtils<span class="token punctuation">.</span><span class="token function">writeErrorMessageJson</span><span class="token punctuation">(</span>ResponseData<span class="token punctuation">.</span>ERROR_UNAUTHORIZED<span class="token punctuation">,</span> 
                <span class="token string">&quot;用户没有登录或者超时，请重新登录&quot;</span><span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> JsonResultUtils<span class="token punctuation">.</span><span class="token function">writeSingleDataJson</span><span class="token punctuation">(</span>
                DictionaryMapUtils<span class="token punctuation">.</span><span class="token function">objectsToJSONArray</span><span class="token punctuation">(</span>
                CodeRepositoryUtil<span class="token punctuation">.</span><span class="token function">listUserUnitsByRank</span><span class="token punctuation">(</span>centitUserDetails<span class="token punctuation">.</span><span class="token function">getUserCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rank<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>response <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">//返回多个数据</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>method <span class="token operator">=</span> RequestMethod<span class="token punctuation">.</span>GET<span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token function">ResponseDatalist</span><span class="token punctuation">(</span>PageDesc pageDesc<span class="token punctuation">,</span>
        HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> searchColumn <span class="token operator">=</span> BaseController<span class="token punctuation">.</span><span class="token function">convertSearchColumn</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        listObjects <span class="token operator">=</span> sysUserManager<span class="token punctuation">.</span><span class="token function">listObjects</span><span class="token punctuation">(</span>searchColumn<span class="token punctuation">,</span> pageDesc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ResponseMapData resData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResponseMapData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resData<span class="token punctuation">.</span><span class="token function">addResponseData</span><span class="token punctuation">(</span>BaseController<span class="token punctuation">.</span>OBJLIST<span class="token punctuation">,</span> listObjects<span class="token punctuation">)</span><span class="token punctuation">;</span>
        resData<span class="token punctuation">.</span><span class="token function">addResponseData</span><span class="token punctuation">(</span>BaseController<span class="token punctuation">.</span>PAGE_DESC<span class="token punctuation">,</span> pageDesc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ResponseMapData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>    
<span class="token comment">//或者    </span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>method <span class="token operator">=</span> RequestMethod<span class="token punctuation">.</span>GET<span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">list</span><span class="token punctuation">(</span>PageDesc pageDesc<span class="token punctuation">,</span>
                     HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">&gt;</span></span> searchColumn <span class="token operator">=</span> BaseController<span class="token punctuation">.</span><span class="token function">convertSearchColumn</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        listObjects <span class="token operator">=</span> sysUserManager<span class="token punctuation">.</span><span class="token function">listObjects</span><span class="token punctuation">(</span>searchColumn<span class="token punctuation">,</span> pageDesc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ResponseMapData resData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResponseMapData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resData<span class="token punctuation">.</span><span class="token function">addResponseData</span><span class="token punctuation">(</span>BaseController<span class="token punctuation">.</span>OBJLIST<span class="token punctuation">,</span> listObjects<span class="token punctuation">)</span><span class="token punctuation">;</span>
        resData<span class="token punctuation">.</span><span class="token function">addResponseData</span><span class="token punctuation">(</span>BaseController<span class="token punctuation">.</span>PAGE_DESC<span class="token punctuation">,</span> pageDesc<span class="token punctuation">)</span><span class="token punctuation">;</span>

        JsonResultUtils<span class="token punctuation">.</span><span class="token function">writeResponseDataAsJson</span><span class="token punctuation">(</span>resData<span class="token punctuation">,</span> response<span class="token punctuation">,</span> simplePropertyPreFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><p>前端获取后端返回的json字符串可以使用<a href="http://gitlab.centit.com/gitlab/ctm/centit-framework/blob/master/framework-adapter/src/main/java/com/centit/framework/common/ResponseJSON.java" target="_blank" rel="noopener noreferrer">ResponseJSON</a>来解析。示例代码：</p><p>java客户端</p><pre class="language-java"><code>CloseableHttpClient client <span class="token operator">=</span> HttpExecutor<span class="token punctuation">.</span><span class="token function">createKeepSessionHttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ResponseJSON resJson <span class="token operator">=</span> ResponseJSON<span class="token punctuation">.</span><span class="token function">valueOfJson</span><span class="token punctuation">(</span>HttpExecutor<span class="token punctuation">.</span><span class="token function">simpleGet</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>js客户端</p><pre class="language-js"><code><span class="token comment">//请张凯补充</span>
</code></pre><h2 id="参数驱动sql"><a href="#参数驱动sql" aria-hidden="true" class="header-anchor">#</a> 参数驱动SQL</h2><h2 id="数据持久化"><a href="#数据持久化" aria-hidden="true" class="header-anchor">#</a> 数据持久化</h2><h2 id="mvc分层设计和脚手架"><a href="#mvc分层设计和脚手架" aria-hidden="true" class="header-anchor">#</a> MVC分层设计和脚手架</h2></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/environment_structure/" class="prev router-link-active">
          框架的总体设计
        </a></span><span class="next"><a href="/environment_structure/tong-yong-hou-tai-gong-neng.html">
          平台功能设计
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/6.27f6fe8f.js" defer></script><script src="/assets/js/app.fd345311.js" defer></script>
  </body>
</html>
